





# 0.前言

两个计算机是如何找到对方并将数据发送给对方的？



# 1.物理层

两台计算机怎么通信的呢？

- 两台计算机通过双绞线、光纤等等连接起来才能通信

**物理层的作用：**将两个计算机双绞线、光纤、电缆等连接起来，并之后计算机在通过高低频来传送0,1这样的电信号



# 2.数据链路层

物理层只是连接起来，并传输电信号。

但电信号没有组织规则，无法知道发送的具体含义，这样就无法知道传输对象是谁？发送者是谁？

![image-20220524105952813](pic/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%BA%94%E5%B1%82%E6%A8%A1%E5%9E%8B%E5%85%A5%E9%97%A8.assets/image-20220524105952813.png)





没有规则计算机怎么才能明白电信号的含义：为电信号制定一套规则，如多少个为一组、每组信号如何标识，有了以太网协议

### 1) 以太网协议

以太网协议规定一组电信号构成一个数据包称为帧，帧分为head Data部分

<img src="pic/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%BA%94%E5%B1%82%E6%A8%A1%E5%9E%8B%E5%85%A5%E9%97%A8.assets/image-20220524110224649.png" alt="image-20220524110224649" style="zoom: 25%;" />

head部分长度固定18个字节，主要是说明信息，包含了发送者地址、接受者的地址

Data不固定才是具体要传输的数据







### 2) MAC地址

但计算机如何区分，我们如何标识每一台计算机呢？

每台计算机接入网络时，都有一个网卡接口，每个网卡都有唯一的地址，，这个地址就是MAC地址

计算机数据的传输就是通过MAC地址来寻址的

MAC地址由48个二进制位所构成，在网卡生产时就被唯一标识了。

<img src="pic/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%BA%94%E5%B1%82%E6%A8%A1%E5%9E%8B%E5%85%A5%E9%97%A8.assets/image-20220524110851209.png" alt="image-20220524110851209" style="zoom:33%;" />





虽然有了MAC地址，但如何找到他并传送数据呢？

### 3) 广播与ARP协议

**广播**

计算机A连接着多台计算机，假如想发送数据给B？

通过广播，A在**子网**内向所有计算机广播自己要发送的数据包，这时BCD都会收到数据包，他们将数据包中接受者的MAC地址与自己的MAC地址对比，如果一致那么就收下数据包，否则扔掉。

这种发送数据的方式就是广播。(就想学校广播找人，如果听到的不是自己的名字就假装没有听到)

> 因此，广播就是一种发送数据的方式

<img src="pic/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%BA%94%E5%B1%82%E6%A8%A1%E5%9E%8B%E5%85%A5%E9%97%A8.assets/image-20220524111332310.png" alt="image-20220524111332310" style="zoom: 33%;" />



**ARP协议**

那么计算机A如何知道B的地址的呢？

> 通过ARP计算机A可以知道子网内其他所有计算机的地址







# 3. 网络层

我们的网络是由多个子网组成的。

为什么要有子网？广播发送数据包时，如果向全世界的计算机都发送数据包那是不可能的，因此需要划分子网。





那么我们如何知道即将传送的对象是否和自己是同一个子网的呢？

- 如果是同一个子网就以广播的形式发送数据包给对方，
- 如果不是同一个子网就发送给网关，让网关转发

### 1)  IP协议



**1.1 IP地址**

IP协议定义的地址，叫IP地址。

每个接入网络的计算机都有唯一的IP地址。IP地址由32位组成0.0.0.0~255.255.255.255，分为**主机部分**、**网络部分**， 两部分的长度不固定，每台计算机的两部分长度都不一样。

如果两个计算机的网络部分相同则属于同一个子网，网络部分都不知占IP地址的长度，那么如何判断是否相同呢？有了子网掩码



**1.2 子网掩码**

每个IP地址都带有一个子网掩码，子网掩码与IP地址一样都是32位，但他的网络部分全部是1，主机部分全部为0

用子网掩码与IP地址进行与(AND)操作，得到一个结果。

如何知道两台计算机属于同一个子网呢？

两个计算机IP地址同时与自己的子网掩码进行(AND)操作，如果得到的结果相同则是同一个子网。

> IP协议+子网掩码 可以判断两个计算机是否属于同一个子网



如何知道对方的MAC地址？

### 2) ARP协议

确定了目标计算机是否属于同一个子网之后，(不是一个子网就转发数据包给网关)就可以通过ARP协议来获取子网内所有计算机的MAC地址了。

**2.1 ARP获取子网内计算机的地址**

ARP在子网内，向子网广播一个数据包，数据包中有想要知道MAC地址的计算机的IP地址。子网内计算机收到数据包后与自己的IP地址对比，如果IP地址相同则接受数据包，并回复MAC地址给对方。

<img src="pic/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%BA%94%E5%B1%82%E6%A8%A1%E5%9E%8B%E5%85%A5%E9%97%A8.assets/image-20220524115600006.png" alt="image-20220524115600006" style="zoom: 25%;" />

**2.2 询问MAC地址与**

询问MAC地址与发送数据都是计算机A广播一个数据包，那么如何知道对方是发送数据还是获取MAC地址(只有知道了BCD才会知道是比对IP地址呢，还是比对MAC地址)



真实的询问MAC地址时，A发送的数据包会在接受者的MAC地址这一栏写一个特殊的地址，这样所有子网内的计算机看到就知道是在询问MAC地址了





我们在判断对方是否与自己是同一个子网时通过的是IP地址，但如何知道对方的IP地址呢？

### 3) DNS服务器

当然是客户端来输入要访问对象的IP地址的了。

但通常我们输入的是域名，如想要访问百度`www.baidu.com`(IP地址不容易记住)，DNS服务器将域名即解析，并发送IP地址给我们



> 网络层作用：在茫茫计算机中找到对方，确定是否和对方在同一个子网



# 4. 传输层

通过下面三层：物理层、数据链路层、网络层，数据包已经能从计算机A传输到计算机B。

但B中有各种各样的程序，如何知道数据包是传给哪个程序的呢？

**端口Port**：计算机传输给对方时还需要指定端口



有的协议已经默认了端口，比如访问百度时候，没有指定百度服务器的端口。例如http的传输默认端口是80，这些端口信息也会包含在数据包里的



> 传输层的作用：实现端到端的数据传输（上面是实现计算机到计算机的传输）



# 5. 应用层

应用程序收到各种各样格式的数据，我们如何看得懂？



因此我们需要指定每种格式的规则，这样收到数据时才能对对应的格式进行渲染。

例如我们最常见的 Http 数据包中，就会指定该数据包是 什么格式的文件了。

> 作用：对每种格式制定规则



# 参考链接

[帅地玩编程](https://www.iamshuaidi.com/747.html)







